{% extends "Login_Page/login_base_template.html" %}
{% load static %}

{% block css_block %}
  <link rel="stylesheet" href="{% static 'css/add_result.css' %}">
  <script src="{% static 'js/add_result.js' %}"></script>
{% endblock %}

{% block title %}
    NCC (National Cadet Corps)
{% endblock %}

{% block script %}
<script>
    
  function updateLabel(input) {
      const label = document.querySelector(`label[for="${input.id}"]`);
      if (input.files.length > 0) {
          label.textContent = input.files[0].name; // Update label with file name
      } else {
          label.textContent = input.id === "inputGroupFile01" ? "Upload Excel File" : "Upload Photos Folder";
      }
  }

  function updateFolderLabel(input) {
      const label = document.querySelector(`label[for="${input.id}"]`);
      if (input.files.length > 0) {
          const fullPath = input.files[0].webkitRelativePath;
          const folderName = fullPath.split('/')[0]; // Extract folder name
          label.textContent = folderName; // Update label with folder name
      } else {
          label.textContent = "Upload Photos Folder";
      }
  }
</script>
{% endblock script %}

{% block start %}
    <div class="center-area">
        {% if messages %}
            <div class="alert alert-primary alert-dismissible" id="success-alert">
                {% for message in messages %}
                    {{message}}
                {% endfor %}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endif %}
        <form class="register-students" method="post" enctype="multipart/form-data" action="/upload-omr/">
            {% csrf_token %}
            <header>Upload OMR Result</header>
            <input name="type" value="upload" hidden/>
            <div class="mb-3">
                <label for="regimental_no" class="form-label">Regimental No</label>
                <input type="text" class="form-control" name="regimental_no" placeholder="Regimental No Cell">
              </div>
            <div class="table-container">
                <table class="table table-bordered table2">
                <thead>
                    <tr>
                        <th scope="col">Type</th>
                        <th scope="col">Cell Start</th>
                        <th scope="col">Cell End</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Drill</td>
                        <td><input type="text" class="form-control" name="drill-cell-start" placeholder="Question Range Start"></td>
                        <td><input type="text" class="form-control" name="drill-cell-end" placeholder="Question Range End"></td>
                    </tr>
                    <tr>
                        <td>WT</td>
                        <td><input type="text" class="form-control" name="wt-cell-start" placeholder="Question Range Start"></td>
                        <td><input type="text" class="form-control" name="wt-cell-end" placeholder="Question Range End"></td>
                    </tr>
                    <tr>
                        <td>Misc</td>
                        <td><input type="text" class="form-control" name="misc-cell-start" placeholder="Question Range Start"></td>
                        <td><input type="text" class="form-control" name="misc-cell-end" placeholder="Question Range End"></td>
                    </tr>
                    <tr>
                        <td>Spl to Corps</td>
                        <td><input type="text" class="form-control" name="stc-cell-start" placeholder="Question Range Start"></td>
                        <td><input type="text" class="form-control" name="stc-cell-end" placeholder="Question Range End"></td>
                    </tr>
                </tbody>
                </table>
            </div>
            <div class="input-group">
                <div class="file-input">
                    <input type="file" class="form-control" id="inputGroupFile01" name="excel_file" onchange="updateLabel(this)">
                    <label class="input-group-text" for="inputGroupFile01" id="inputGroupFile01Label">Upload Excel File</label>
                </div>
            </div>
            <div class="submit-container">
                <button type="submit" class="submit-btn">Submit</button>
            </div>
        </form>
        <div class="notice">
            <div><strong>Notices</strong></div>
            <div> Excel file must be with .xls or .xlsx extension.</div>
        </div>
    </div>
{% endblock %}